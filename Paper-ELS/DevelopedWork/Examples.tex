%3/code.scm
\begin{lstlisting}[basicstyle=\ttfamily, caption="example"]
  (if (>= n_jogadas 35)
        #T
        #F)
\end{lstlisting}

\begin{lstlisting}[basicstyle=\ttfamily, caption="example"]
(and (and (eq? #t (movimento-valido? jogador jogada))
                 (eq? #t (pe�a-jogador? jogador jogada)))
            (and (eq? #t (casa-destino-vazia? jogada))
                 (eq? #t (casa-inicial-vazia? jogada))))
\end{lstlisting}

\begin{lstlisting}[basicstyle=\ttfamily, caption="example"]
(define (jogo-perdido-pretas?)
    (if (or (vector-search "p" a)
                (vector-search "p" b)
                (vector-search "p" c)
                (vector-search "p" d)
                (vector-search "p" e)
                (vector-search "p" f)
                (vector-search "p" g)
                (vector-search "p" h))
        #F
        #T))
\end{lstlisting}
\begin{lstlisting}[basicstyle=\ttfamily, caption="example"]
(define (jogo-perdido-brancas?)
  (if (or (vector-search "b" a)
              (vector-search "b" b)
              (vector-search "b" c)
              (vector-search "b" d)
              (vector-search "b" e)
              (vector-search "b" f)
              (vector-search "b" g)
              (vector-search "b" h))
      #F
      #T))
\end{lstlisting}
\begin{lstlisting}[basicstyle=\ttfamily, caption="example"]
(if (and (and (eq? #t (movimento-valido? jogador jogada))
                 (eq? #t (pe�a-jogador? jogador jogada)))
            (and (eq? #t (casa-destino-vazia? jogada))
                 (eq? #t (casa-inicial-vazia? jogada))))
       (efectua-jogada tab jogada)
       (error "Jogada invalidada: ")))
\end{lstlisting}
\begin{lstlisting}[basicstyle=\ttfamily, caption="example"]
(define (jogo-empatado? tab)
 (define (cont jogador)
   (cond  ((eq? jogador 'pretas)
           (set! n_jogadas (add1 n_jogadas)))
          (else (set! n_jogadas (+ 0 n_jogadas)))))
 (if (>= n_jogadas 35)
   #T
   #F))
\end{lstlisting}
\begin{lstlisting}[basicstyle=\ttfamily, caption="example"]
   (define (movimento-dama-livre jogada)
     (begin (if (and (and (eq? (first (rest (rest (rest jogada)))) (- (first (rest jogada)) 1))
                          (eq? (first jogada) (- (first jogada) 1)))
            (and (eq? (first (rest (rest (rest jogada)))) (- (first (rest jogada)) 2))
                 (eq? (first jogada) (- (first jogada) 2)))
            (and (eq? (first (rest (rest (rest jogada)))) (- (first (rest jogada)) 3))
                 (eq? (first jogada) (- (first jogada) 3)))
            (and (eq? (first (rest (rest (rest jogada)))) (- (first (rest jogada)) 4))
                 (eq? (first jogada) (- (first jogada) 4)))
            (and (eq? (first (rest (rest (rest jogada)))) (- (first (rest jogada)) 5))
                 (eq? (first jogada) (- (first jogada) 5)))
            (and (eq? (first (rest (rest (rest jogada)))) (- (first (rest jogada)) 6))
                 (eq? (first jogada) (- (first jogada) 6)))
            (and (eq? (first (rest (rest (rest jogada)))) (- (first (rest jogada)) 7))
                 (eq? (first jogada) (- (first jogada) 7)))
            (and (eq? (first (rest (rest (rest jogada)))) (+ (first (rest jogada)) 1))
                 (eq? (first jogada) (+ (first jogada) 1)))
            (and (eq? (first (rest (rest (rest jogada)))) (+ (first (rest jogada)) 2))
                 (eq? (first jogada) (+ (first jogada) 2)))
            (and (eq? (first (rest (rest (rest jogada)))) (+ (first (rest jogada)) 3))
                 (eq? (first jogada) (+ (first jogada) 3)))
            (and (eq? (first (rest (rest (rest jogada)))) (+ (first (rest jogada)) 4))
                 (eq? (first jogada) (+ (first jogada) 4)))
            (and (eq? (first (rest (rest (rest jogada)))) (+ (first (rest jogada)) 5))
                 (eq? (first jogada) (+ (first jogada) 5)))
            (and (eq? (first (rest (rest (rest jogada)))) (+ (first (rest jogada)) 6))
                 (eq? (first jogada) (+ (first jogada) 6)))
            (and (eq? (first (rest (rest (rest jogada)))) (+ (first (rest jogada)) 7))
                 (eq? (first jogada) (+ (first jogada) 7))))
            jogada
             (display " Movimento-dama: o movimento da dama n�o � valido."))))
\end{lstlisting}
\begin{lstlisting}[basicstyle=\ttfamily, caption="example"]
             (define (movimento-dama-branca jogada)
  (begin (if (or (eq? (vector-ref (+ (first jogada) 1) (+ (first (rest jogada)) 1) "b")
                  (vector-ref (+ (first jogada) 2) (+ (first (rest jogada)) 2) "b")
                  (vector-ref (+ (first jogada) 3) (+ (first (rest jogada)) 3) "b")
                  (vector-ref (+ (first jogada) 4) (+ (first (rest jogada)) 4) "b")
                  (vector-ref (+ (first jogada) 5) (+ (first (rest jogada)) 5) "b")
                  (vector-ref (+ (first jogada) 6) (+ (first (rest jogada)) 6) "b")
                  (vector-ref (+ (first jogada) 6) (+ (first (rest jogada)) 6) "b")
                  (vector-ref (+ (first jogada) 7) (+ (first (rest jogada)) 7) "b")))
             (display "movimento da dama branca: Tem uma pessa da sua cor no caminho da jogada, esta n�o se pode efectuar")
             jogada)))
\end{lstlisting}

;Procedimento q verifica se existe alguma pe�a no caminho da dama preta, que n�o deixe esta efectuar a jogada.
\begin{lstlisting}[basicstyle=\ttfamily, caption="example"]
(define (movimento-dama-preta jogada)
  (begin (if (or (eq? (vector-ref (+ (first jogada) 1) (+ (first (rest jogada)) 1) "p")
                  (vector-ref (+ (first jogada) 2) (+ (first (rest jogada)) 2) "p")
                  (vector-ref (+ (first jogada) 3) (+ (first (rest jogada)) 3) "p")
                  (vector-ref (+ (first jogada) 4) (+ (first (rest jogada)) 4) "p")
                  (vector-ref (+ (first jogada) 5) (+ (first (rest jogada)) 5) "p")
                  (vector-ref (+ (first jogada) 6) (+ (first (rest jogada)) 6) "p")
                  (vector-ref (+ (first jogada) 6) (+ (first (rest jogada)) 6) "p")
                  (vector-ref (+ (first jogada) 7) (+ (first (rest jogada)) 7) "p")))
             (display "movimento da dama branca: Tem uma pessa da sua cor no caminho da jogada, esta n�o se pode efectuar")
             jogada)))
\end{lstlisting}
%2/code.scm
\begin{lstlisting}[basicstyle=\ttfamily, caption="example"]

\end{lstlisting}
\begin{lstlisting}[basicstyle=\ttfamily, caption="example"]

(define (traduz-coluna coluna valor-linha)

  (if (odd? valor-linha)
      (begin
        (let ((coluna-interna (sub1 (/ coluna 2))))
          (if (integer? coluna-interna)
              coluna-interna
              #f)))
      (begin
        (let ((coluna-interna (/ (sub1 coluna) 2)))
          (if (integer? coluna-interna)
              coluna-interna
              #f)))))
\end{lstlisting}


%%%code 5
\begin{lstlisting}[basicstyle=\ttfamily, caption="example"]

(define (algum_inimigo? tabuleiro tipo_peca conjunto_coord)
    (if (null? conjunto_coord)
        #f
        (if (inimigo? tabuleiro tipo_peca (first conjunto_coord))
            #t
            (algum_inimigo? tabuleiro tipo_peca (rest conjunto_coord)))))
          \end{lstlisting}


%%%code 6
\begin{lstlisting}[basicstyle=\ttfamily, caption="example"]

;verifica se a jogada efectuada n�o efectua qualquer captura e se � valido o movimento
(define (jogada-peao-sem-captura-valida? tab jogada)
  (if (and (eq? (jogador jogada) 'brancas)
           (= (linha-destino jogada)
              (+ (linha-origem jogada) 1))
           (or (= (coluna-destino jogada)
                  (+ (coluna-origem jogada) 1))
               (= (coluna-destino jogada)
                  (- (coluna-origem jogada) 1))))
      #t
      #f)
  (if (and (eq? (jogador jogada) 'pretas)
           (= (linha-destino jogada)
              (- (linha-origem jogada) 1))
           (or (= (coluna-destino jogada)
                  (+ (coluna-origem jogada) 1))
               (= (coluna-destino jogada)
                  (- (coluna-origem jogada) 1))))
      #t
      #f))

      ;verifica se a jogada efectuada tem captura e se � v�lida a captura e o movimento
      (define (jogada-peao-com-captura-valida? tab jogada)
        (if (and (eq? (jogador jogada) 'brancas)
                 (= (linha-destino jogada)
                    (+ (linha-origem jogada) 2))
                 (or (and (= (coluna-destino jogada)
                             (+ (coluna-origem jogada) 2))
                          (not (string=? (tabuleiro-da-casa tab (+ (linha-origem jogada) 1) (+ (coluna-origem jogada) 1))
                                         " p ")))

                     (and (= (coluna-destino jogada)
                             (- (coluna-origem jogada) 2))
                          (not (string=? (tabuleiro-da-casa tab (+ (linha-origem jogada) 1) (- (coluna-origem jogada) 1))
                                         " p ")))))
            #t
            #f)
        (if (and (eq? (jogador jogada) 'pretas)
                 (= (linha-destino jogada)
                    (- (linha-origem jogada) 2))
                 (or (and (= (coluna-destino jogada)
                             (+ (coluna-origem jogada) 2))
                          (not (string=? (tabuleiro-da-casa tab (+ (linha-origem jogada) 1) (+ (coluna-origem jogada) 1))
                                         " b ")))
                     (and (= (coluna-destino jogada)
                             (- (coluna-origem jogada) 2))
                          (not (string=? (tabuleiro-da-casa tab (+ (linha-origem jogada) 1) (- (coluna-origem jogada) 1))
                                         " b ")))))
            #t
            #f))

          \end{lstlisting}

            %%%39
            \begin{lstlisting}[basicstyle=\ttfamily, caption="example"]

            (if (casa-adjacente? origem destino)
                            (if (eq? (tabuleiro-da-casa tab
                                                        (linha-seguinte linha-origem)
                                                        (- coluna-origem 1))
                                     'casa-vazia)
                                #t
                                #f)
                            (if (eq? (tabuleiro-da-casa tab
                                                        (linha-seguinte linha-origem)
                                                        (- coluna-origem 1))
                                     'casa-vazia)
                                (ciclo-captura (list (linha-seguinte linha-origem) (- coluna-origem 1))
                                               destino
                                               pecas-eliminadas)
                                (if (peca-jogador? tab
                                                   jogador
                                                   (linha-seguinte linha-origem)
                                                   (- coluna-origem 1))
                                    #f
                                    (ciclo-captura (list (linha-seguinte linha-origem) (- coluna-origem 1))
                                                   destino
                                                   (+ pecas-eliminadas 1)))))
                                                 \end{lstlisting}
\begin{lstlisting}[basicstyle=\ttfamily, caption="example"]
(define (procura-aux? tabuleiro linha coluna peca)
 (if (> coluna 8)
     #f
     (if (= linha 1)
         (if (eq? (tabuleiro-da-casa tabuleiro 1 coluna) peca)
             #t
             (procura-aux? tabuleiro linha (+ 2 coluna) peca))
         (if (= linha 2)
             (if (eq? (tabuleiro-da-casa tabuleiro 2 coluna) peca)
                 #t
                 (procura-aux? tabuleiro linha (+ 2 coluna) peca))
             (if (= linha 3)
                 (if (eq? (tabuleiro-da-casa tabuleiro 3 coluna) peca)
                     #t
                     (procura-aux? tabuleiro linha (+ 2 coluna) peca))
                 (if (= linha 4)
                     (if (eq? (tabuleiro-da-casa tabuleiro 4 coluna) peca)
                         #t
                         (procura-aux? tabuleiro linha (+ 2 coluna) peca))
                     (if (= linha 5)
                         (if (eq? (tabuleiro-da-casa tabuleiro 5 coluna) peca)
                             #t
                             (procura-aux? tabuleiro linha (+ 2 coluna) peca))
                         (if (= linha 6)
                             (if (eq? (tabuleiro-da-casa tabuleiro 6 coluna) peca)
                                 #t
                                 (procura-aux? tabuleiro linha (+ 2 coluna) peca))
                             (if (= linha 7)
                                 (if (eq? (tabuleiro-da-casa tabuleiro 7 coluna) peca)
                                     #t
                                     (procura-aux? tabuleiro linha (+ 2 coluna) peca))
                                 (if (= linha 8)
                                     (if (eq? (tabuleiro-da-casa tabuleiro 8 coluna) peca)
                                         #t
                                         (procura-aux? tabuleiro linha (+ 2 coluna) peca))))))))))))

                                         \end{lstlisting}
